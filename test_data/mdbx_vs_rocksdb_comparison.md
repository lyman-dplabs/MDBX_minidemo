# MDBX vs RocksDB 基准测试对比报告

## 执行摘要

本报告对比了 MDBX 和 RocksDB 数据库在 20 亿键值对相同基准测试负载下的性能表现。两个数据库都使用 32 字节键和 32 字节值进行测试，涵盖四个测试类别：只读、只写、更新（先读后写）和混合读写操作。

### 主要发现

- **读取测试**: RocksDB 平均延迟优于 MDBX 81.4%
- **写入测试**: RocksDB 平均延迟优于 MDBX 100.0%
- **更新测试**: RocksDB 平均延迟优于 MDBX 87.0%
- **混合测试**: RocksDB 平均延迟优于 MDBX 89.8%

### 测试配置
- **数据集大小**: 2,000,000,000 键值对
- **键大小**: 32 字节
- **值大小**: 32 字节  
- **测试轮次**: 每种测试类型 100 轮
- **每轮操作数**: 100,000 次操作

## 详细性能分析

### 读取性能

| 指标 | MDBX | RocksDB | 提升 |
|------|------|---------|------|
| 平均延迟 | 256.05 μs | 47.56 μs | +81.4% |
| TP99 延迟 | 557.69 μs | 163.96 μs | +70.6% |
| 总时间 | 25696.66 ms | 4836.03 ms | +81.2% |
| 吞吐量 | 3962.09 ops/sec | 21965.13 ops/sec | +454.4% |

**分析**: RocksDB 在读取性能方面表现出显著优势，延迟降低了 81.4%。比较反直觉.

### 写入性能

| 指标 | MDBX | RocksDB | 提升 |
|------|------|---------|------|
| 平均延迟 | 361.23 μs | 0.01 μs | +100.0% |
| TP99 延迟 | 904.95 μs | 0.00 μs | +100.0% |
| 总时间 | 36238.96 ms | 38.90 ms | +99.9% |
| 吞吐量 | 2783.48 ops/sec | 2572183.24 ops/sec | +92309.0% |
| 提交时间 | 962.08 ms | 335.15 ms | - |

**分析**: 写入几乎是完全碾压，比较符合直觉.

### 更新性能

| 指标 | MDBX | RocksDB | 提升 |
|------|------|---------|------|
| 平均延迟 | 158.72 μs | 20.65 μs | +87.0% |
| TP99 延迟 | 502.57 μs | 149.47 μs | +70.3% |
| 总时间 | 31936.81 ms | 4247.86 ms | +86.7% |
| 吞吐量 | 6274.35 ops/sec | 50346.07 ops/sec | +702.4% |
| 提交时间 | 1800.25 ms | 336.61 ms | - |

**分析**: 更新操作涉及读取和写入两个方面。RocksDB 在单独操作中的性能优势转化为更好的整体更新性能，尽管由于工作负载的混合性质，差距有所缩小。

### 混合性能

| 指标 | MDBX | RocksDB | 提升 |
|------|------|---------|------|
| 平均延迟 | 261.96 μs | 26.80 μs | +89.8% |
| TP99 延迟 | 596.01 μs | 113.43 μs | +81.0% |
| 总时间 | 26637.77 ms | 2820.16 ms | +89.4% |
| 吞吐量 | 3760.62 ops/sec | 35464.02 ops/sec | +843.0% |
| 提交时间 | 348.66 ms | 71.05 ms | - |

**分析**: 混合工作负载（80% 读取，20% 写入）显示了 RocksDB 在两种操作类型上的均衡性能。
